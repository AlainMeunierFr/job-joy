/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details
*/
define("geoloc/domReady",function(){var isTop,testDiv,scrollIntervalId,isBrowser=typeof window!=="undefined"&&window.document,isPageLoaded=!isBrowser,doc=isBrowser?document:null,readyCalls=[];function runCallbacks(callbacks){var i;for(i=0;i<callbacks.length;i+=1)callbacks[i](doc)}function callReady(){var callbacks=readyCalls;if(isPageLoaded)if(callbacks.length){readyCalls=[];runCallbacks(callbacks)}}function pageLoaded(){if(!isPageLoaded){isPageLoaded=true;if(scrollIntervalId)clearInterval(scrollIntervalId);
callReady()}}if(isBrowser){if(document.addEventListener){document.addEventListener("DOMContentLoaded",pageLoaded,false);window.addEventListener("load",pageLoaded,false)}else if(window.attachEvent){window.attachEvent("onload",pageLoaded);testDiv=document.createElement("div");try{isTop=window.frameElement===null}catch(e){}if(testDiv.doScroll&&(isTop&&window.external))scrollIntervalId=setInterval(function(){try{testDiv.doScroll();pageLoaded()}catch(e){}},30)}if(document.readyState==="complete")pageLoaded()}function domReady(callback){if(isPageLoaded)callback(doc);
else readyCalls.push(callback);return domReady}domReady.version="2.0.1";domReady.load=function(name,req,onLoad,config){if(config.isBuild)onLoad(null);else domReady(onLoad)};return domReady});
define("geoloc/map-render",["jquery","geoloc/domReady","geoloc/mapContainer","underscore"],function($,domReady,MapContainer,_){var mapContainer,toggleMapClass="with-map",outsideMapSelector="."+toggleMapClass+" .panel-left, ."+toggleMapClass+" .panel-center",$mapClassHolder=$("body");var filtrerItemsSansCoordonnees=function(items){return _.reject(items,function(item){return item.coordonnees===undefined||(item.coordonnees.lat===undefined||item.coordonnees.lon===undefined)})};return{init:function(){$(document).on("click",
".btn-map",function(event){event.preventDefault();if(mapContainer.map==null){mapContainer.createMap();if(mapContainer.items!=null&&mapContainer.items.length>0)mapContainer.initMarkers()}$mapClassHolder.addClass(toggleMapClass)}).on("click",".panel-map .btn-nav",function(e){$mapClassHolder.removeClass(toggleMapClass)}).on("click",outsideMapSelector,function(e){if(!$(e.target).hasClass("btn-map")&&$mapClassHolder.hasClass(toggleMapClass))$mapClassHolder.removeClass(toggleMapClass)})},renderMap:function(idElement,
items,nbreTotalResultat,defaults,smarttag){domReady(function(){if(idElement==null&&(defaults!=null&&mapContainer==null))mapContainer=new MapContainer($("#map-offres"),filtrerItemsSansCoordonnees(items),nbreTotalResultat,defaults,smarttag);else if(idElement==null&&(defaults==null&&(items!=null&&mapContainer!=null))){mapContainer.items=filtrerItemsSansCoordonnees(items);mapContainer.nbreTotalResultat=nbreTotalResultat;if(mapContainer.map!=null&&(mapContainer.items!=null&&mapContainer.items.length>0))mapContainer.initMarkers()}})}}});
define("geoloc/mapContainer",["jquery","geoloc/domReady","t5/core/ajax"],function($,domReady,ajax){function _slicedToArray(arr,i){return _arrayWithHoles(arr)||(_iterableToArrayLimit(arr,i)||(_unsupportedIterableToArray(arr,i)||_nonIterableRest()))}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===
"string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(r,l){var t=null==r?null:
"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&(null!=t.return&&(u=t.return(),Object(u)!==u)))return}finally{if(o)throw n;}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var mapSessionId=String(Math.random()).substring(2,14);var apikey="";if(window.location.href.includes("candidat.francetravail.fr"))apikey=
"wUFvlQtYQdW9WRV526GEKw3mHj9Kn9fo";else apikey="5AZTpHq8D0m5JK5WYhnWgra4imfcfw4E";var addParamsToUrl=function addParamsToUrl(){var url=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var params=arguments.length>1?arguments[1]:undefined;if(!params)return url;var sep=url.includes("?")?"\x26":"?";var extra_params="";for(var _i=0,_Object$entries=Object.entries(params);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],val=
_Object$entries$_i[1];extra_params+="".concat(key,"\x3d").concat(val,"\x26")}extra_params=extra_params.slice(0,-1);return"".concat(url).concat(sep).concat(extra_params)};MapContainer.defaults={};function MapContainer(element,items,nbreTotalResultat,defaults,smarttag){this.initialize(element,items,nbreTotalResultat,defaults,smarttag)}MapContainer.prototype={map:null,markers:[],clusterGroup:null,popin:null,items:null,defaults:null,smarttag:null,element:null,nbreTotalResultat:0,initialize:function(element,
items,nbreTotalResultat,defaults,smarttag){this.element=element;this.items=items;this.defaults=defaults;this.smarttag=smarttag;this.nbreTotalResultat=nbreTotalResultat},createMap:function(){this.map=new maplibregl.Map({container:"map",style:"https://api-map.mappy.net/map/1.0/vector/mappy_map.json",transformRequest:function transformRequest(url){var params={mapSessionId:mapSessionId};if(apikey)params.apikey=apikey;return{url:addParamsToUrl(url,params)}},center:{lat:48.8607,lon:2.3281},zoom:5});if(this.items!=
null&&this.items.length>0)this.initMarkers()},initMarkers:function(){var self=this;this.clearMarkers(self.markers);self.markers=[];var highestLat=self.items[0].coordonnees.lat;var highestLon=self.items[0].coordonnees.lon;var lowestLat=self.items[0].coordonnees.lat;var lowestLon=self.items[0].coordonnees.lon;var limitTo=self.items.length>150?150:self.items.length;for(var i=0;i<limitTo;i++){var item=self.items[i];for(var j=0;j<self.markers.length;j++)if(self.markers[j].getLngLat().lng===item.coordonnees.lon&&
self.markers[j].getLngLat().lat===item.coordonnees.lat){item.coordonnees.lon=item.coordonnees.lon+6E-4*Math.sin(i/5)*(i/50);item.coordonnees.lat=item.coordonnees.lat+4E-4*Math.cos(i/5)*(i/50)}highestLat=item.coordonnees.lat>highestLat?item.coordonnees.lat:highestLat;lowestLat=item.coordonnees.lat<lowestLat?item.coordonnees.lat:lowestLat;highestLon=item.coordonnees.lon>highestLon?item.coordonnees.lon:highestLon;lowestLon=item.coordonnees.lon<lowestLon?item.coordonnees.lon:lowestLon;var libelle=self.defaults.libelleLien;
var order=self.defaults.order;self.markers[i]=(new maplibregl.Marker({color:"#ff5950"})).setLngLat(item.coordonnees).addTo(this.map);var desc=this.getDescription(item,order);var icons=this.getIconGroup(item,order);var tooltip_hd,tooltip_bd,tooltip_ft;tooltip_hd='\x3cdiv class\x3d"tooltip-hd"\x3e\x3cp class\x3d"title"\x3e\x3ca data-event\x3d"'+self.defaults.eventALancer+'" data-context\x3d"'+item.content.id+'" id\x3d"mapPagelink_'+i+'" href\x3d"'+self.defaults.baseHrefPourDetail+item.content.id+'"\x3e'+
item.content.title+'\x3c/a\x3e\x3cspan class\x3d"subtitle"\x3e'+item.content.subtitle+"\x3c/span\x3e\x3c/p\x3e\x3c/div\x3e";tooltip_bd='\x3cdiv class\x3d"tooltip-bd"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col-xs-6"\x3e'+desc+'\x3c/div\x3e\x3cdiv class\x3d"col-xs-6"\x3e'+'\x3cdl class\x3d"icon-group"\x3e'+icons+"\x3c/dl\x3e"+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";if(self.smarttag!=null)tooltip_ft='\x3cdiv class\x3d"tooltip-ft"\x3e\x3cp\x3e\x3ca data-event\x3d"'+self.defaults.eventALancer+'" data-context\x3d"'+
item.content.id+'" id\x3d"mapPagelink_'+i+'" class\x3d"btn btn-primary btn-sm" role\x3d"button" href\x3d"'+self.defaults.baseHrefPourDetail+item.content.id+'" onClick\x3d"'+self.smarttag+'"\x3e'+libelle+"\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e";else tooltip_ft='\x3cdiv class\x3d"tooltip-ft"\x3e\x3cp\x3e\x3ca data-event\x3d"'+self.defaults.eventALancer+'" data-context\x3d"'+item.content.id+'" id\x3d"mapPagelink_'+i+'" class\x3d"btn btn-primary btn-sm" role\x3d"button" href\x3d"'+self.defaults.baseHrefPourDetail+
item.content.id+'"\x3e'+libelle+"\x3c/a\x3e\x3c/p\x3e\x3c/div\x3e";var popup=new maplibregl.Popup;popup.setHTML(tooltip_hd+tooltip_bd+tooltip_ft);self.markers[i].setPopup(popup);$(".leaflet-popup .btn-primary").on("click",function(e){$("body").addClass("modal-details-open")});$(document).on("click","#mapPagelink_"+i,function(event){if(event.which!==2){var _this=$(this);event.preventDefault();history.pushState("detail","Page détail",_this.attr("href"));_this.trigger(_this.data("event"),_this.data("context"));
var elementLien=_this.parents(".result");elementLien.addClass("active");$("#PopinDetails").on("hidden.bs.modal",function(){history.back();$(this).off("hidden.bs.modal");elementLien.removeClass("active").addClass("seen");$("body").removeClass("modal-details-open")})}})}var center={lat:(highestLat+lowestLat)/2,lon:(highestLon+lowestLon)/2};var dist=highestLat-lowestLat>highestLon-lowestLon?highestLat-lowestLat:highestLon-lowestLon;this.map.setCenter(center);var zoomLevels=[{dist:15,zoom:2},{dist:11,
zoom:4},{dist:6,zoom:5},{dist:3,zoom:6},{dist:2,zoom:7},{dist:0.8,zoom:8},{dist:0.4,zoom:9},{dist:0.1,zoom:10},{dist:0.07,zoom:11},{dist:0.05,zoom:12},{dist:0.03,zoom:13},{dist:0,zoom:14}];for(var l=0;l<zoomLevels.length;l++)if(dist>zoomLevels[l].dist){this.map.setZoom(zoomLevels[l].zoom);break}},clearMarkers:function(markers){for(var i=0;i<markers.length;i++)markers[i].remove()},getDescription:function(item,order){var description,subdescription;if(!item.content.description)description="";else description=
'\x3cp class\x3d"description"\x3e'+item.content.description+"\x3c/p\x3e";if(!item.content.subdescription)subdescription="";else subdescription='\x3cp class\x3d"subdescription"\x3e'+item.content.subdescription+"\x3c/p\x3e";return order.descriptionFirst?description+subdescription:subdescription+description},address:function(item){return'\x3cdt\x3e\x3cspan class\x3d"icon-pinmap-location" aria-hidden\x3d"true" title\x3d"Lieu de la formation"\x3e\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eLieu de la formation\x3c/span\x3e\x3c/dt\x3e\x3cdd\x3e'+
item.content.address+"\x3c/dd\x3e"},typeFormation:function(item){return'\x3cdt\x3e\x3cspan class\x3d"icon-formation" aria-hidden\x3d"true" title\x3d"Type de formation"\x3e\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eType de formation\x3c/span\x3e\x3c/dt\x3e\x3cdd\x3e'+item.content.typeFormation+"\x3c/dd\x3e"},certifiante:function(item){return item.content.certifiante?'\x3cdt\x3e\x3cspan class\x3d"icon-experience" aria-hidden\x3d"true" title\x3d"Certification"\x3e\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eLa formation est-elle certifiante ?\x3c/span\x3e\x3c/dt\x3e\x3cdd\x3eCertifiante\x3c/dd\x3e':
""},typeContrat:function(item){return'\x3cdt\x3e\x3cspan class\x3d"icon-malette-poste" aria-hidden\x3d"true" title\x3d"Type de contrat"\x3e\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eType de contrat\x3c/span\x3e\x3c/dt\x3e\x3cdd\x3e'+item.content.contract+"\x3c/dd\x3e"},alternance:function(item){if(item.content.alternance==="")return"";else return'\x3cdt\x3e\x3cspan class\x3d"icon-accompagner" aria-hidden\x3d"true" title\x3d"Alternance"\x3e\x3c/span\x3e\x3cspan class\x3d"sr-only"\x3eLa formation est-elle proposée en alternance ?\x3c/span\x3e\x3c/dt\x3e\x3cdd\x3e'+
item.content.alternance+"\x3c/dd\x3e"},getIconGroup:function(item,order){var content="";for(var key in order.iconelements)switch(order.iconelements[key]){case "address":content+=this.address(item);break;case "typeFormation":content+=this.typeFormation(item);break;case "certifiante":content+=this.certifiante(item);break;case "typeContrat":content+=this.typeContrat(item);break;case "alternance":content+=this.alternance(item);break;default:}return content},keyboardAction:function(e){var self=this;if(e.keyCode==
27)self.minimizePopin()}};return MapContainer});define("geoloc/rdv-map-render",["jquery","geoloc/domReady","geoloc/rdvMapContainer"],function($,domReady,MapContainer){var mapContainer;return{renderMap:function(item,defaults){domReady(function(){mapContainer=new MapContainer($("#map-rendezvous"),item,defaults);mapContainer.createMap()})}}});
define("geoloc/rdvMapContainer",["jquery"],function($){MapContainer.defaults={};function MapContainer(element,item,defaults){this.initialize(element,item,defaults)}MapContainer.prototype={map:null,markers:[],clusterGroup:null,popin:null,items:null,defaults:null,element:null,nbreTotalResultat:0,initialize:function(element,item,defaults){this.element=element;this.item=item;this.defaults=defaults},createMap:function(){var self=this;var mapCanvasID=this.element[0].id;var southWest=new L.LatLng(75,-180),
northEast=new L.LatLng(-75,180),bounds=new L.LatLngBounds(southWest,northEast),center=[46.498392,2.60376];var item=this.item;this.map=new L.Mappy.Map(mapCanvasID,{clientId:"poleemploi",center:center,zoom:2,minZoom:1,scrollWheelZoom:false,zoomControl:{position:"topleft"},layersControl:false,logoControl:{position:"bottomright",dir:this.defaults.logo.substring(0,this.defaults.logo.length-13)},maxBounds:bounds,tileLayer:{continuousWorld:false,noWrap:true}});L.Mappy.Services.geocodeForward(item.adresse+
" "+item.codepostal,function(results){var coords=results[0].geometry.geometries[0].coordinates.reverse();self.map.setView(coords,15);var marker=L.marker(coords,{icon:self.getAwesomeMarker("darkblue"),bounceOnAdd:false,riseOffset:500,riseOnHover:true,visited:false}).addTo(self.map);var tooltip_hd,tooltip_bd,tooltip_ft;var popup=L.popup({autoPanPadding:new L.Point(50,50)}).setContent(self.getPopupContent(item));marker.bindPopup(popup);$("#collapseMap").on("show.bs.collapse",function(){setTimeout(function(){self.map.invalidateSize();
marker.openPopup()},100)})})},getPopupContent:function(item){var tooltip_hd='\x3cdiv class\x3d"tooltip-hd"\x3e\x3ch4 class\x3d"t4"\x3e'+item.nom+"\x3c/h4\x3e\x3c/div\x3e";var tooltip_bd='\x3cdiv class\x3d"tooltip-bd"\x3e\x3cp class\x3d"description"\x3e'+item.adresse+'\x3c/p\x3e\x3cp class\x3d"description"\x3e'+item.codepostal+"\x3c/p\x3e\x3c/div\x3e";return tooltip_hd+tooltip_bd},getAwesomeMarker:function(color){var awesomeMarker=L.AwesomeMarkers.icon({markerColor:color,icon:"circle",prefix:"fa",
spin:true,shadowSize:[0,0]});return awesomeMarker}};return MapContainer});